# -*- coding: utf-8 -*-
"""
Created on Wed Apr 21 15:16:12 2021

@author: janousu
"""

from fit_pf_curve import fit_pF
import numpy as np

help(fit_pF)

# kentt√§rova pF averages

k_head = [0,1.00,2.00,4.00,8.00,16.10,35.10,80.00,150.00,300.00,500.00]

k_all_watcont = np.array([[58.11,	55.92,	50.96,	41.78,	33.82,	28.58,	24.88,	21.62,	19.76,	17.37,	13.16],
                      [43.81,	41.55,	36.84,	31.55,	27.85,	23.84,	18.49,	13.81,	11.88,	10.19,	8.54],
                      [29.98,	27.60,	24.07,	21.90,	19.77,	17.32,	13.66,	9.79,	8.03,	6.31,	4.48],
                      [45.48,	43.80,	41.21,	39.27,	37.91,	35.72,	33.57,	30.62,	28.90,	24.79,	20.33],
                      [44.83,	44.32,	39.97,	36.22,	32.92,	27.88,	23.05,	19.76,	17.76,	15.92,	13.99],
                      [48.10,	45.82,	44.38,	40.64,	34.14,	29.33,	25.10,	21.83,	20.68,	18.85,	16.10],
                      [43.35,	42.73,	37.69,	32.83,	28.68,	23.78,	20.18,	16.65,	13.69,	10.70,	8.11],
                      [25.54,	24.22,	23.55,	23.09,	22.44,	20.56,	16.86,	12.60,	10.72,	8.02,	6.14],
                      [69.19,	65.46,	60.87,	56.38,	47.54,	40.82,	35.44,	31.23,	29.19,	26.37,	24.62],
                      [45.48,	41.93,	37.70,	33.02,	28.88,	24.91,	20.87,	17.43,	15.59,	13.74,	12.50],
                      [26.62,	26.16,	24.39,	21.67,	19.69,	17.31,	13.40,	9.68,	7.99,	6.04,	4.67]])

k_5_10_watcont = np.array([[58.11,55.92,50.96,41.78,33.82,28.58,24.88,21.62,19.76,17.37,13.16],
                           [45.48,43.80,41.21,39.27,37.91,35.72,33.57,30.62,28.90,24.79,20.33],
                           [48.10,45.82,44.38,40.64,34.14,29.33,25.10,21.83,20.68,18.85,16.10],
                           [69.19,65.46,60.87,56.38,47.54,40.82,35.44,31.23,29.19,26.37,24.62]])

k_30_35_watcont = np.array([[43.81,41.55,36.84,31.55,27.85,23.84,18.49,13.81,11.88,10.19,8.54],
                           [44.83,44.32,39.97,36.22,32.92,27.88,23.05,19.76,17.76,15.92,13.99],
                           [43.35,42.73,37.69,32.83,28.68,23.78,20.18,16.65,13.69,10.70,8.11],
                           [45.48,41.93,37.70,33.02,28.88,24.91,20.87,17.43,15.59,13.74,12.50]])

k_50_65_watcont = np.array([[29.98,27.60,24.07,21.90,19.77,17.32,13.66,9.79,8.03,6.31,4.48],
                           [25.54,24.22,23.55,23.09,22.44,20.56,16.86,12.60,10.72,8.02,6.14],
                           [26.62,26.16,24.39,21.67,19.69,17.31,13.40,9.68,7.99,6.04,4.67]])
                           
pF_para_k_5_65 = fit_pF(k_head, [np.average(k_5_10_watcont, axis=0, weights=~np.isin(k_5_10_watcont, -999)*1),
                        np.average(k_30_35_watcont, axis=0, weights=~np.isin(k_30_35_watcont, -999)*1),
                        np.average(k_50_65_watcont, axis=0, weights=~np.isin(k_50_65_watcont, -999)*1)],
                percentage=True, kPa=True,fig=True)




#p_head = [0,1.008480937,1.309510933,1.610540929,1.853578977,2.008480937,
#          2.184572196,2.485602192,2.786632188,3.087662183,3.388692179,3.689722175]

p_head = [0, 0.01, 0.02, 0.04, 0.07, 0.1, 0.15, 0.3, 0.6, 1.2, 2.4, 4.8]

p_head = [i * 100 for i in p_head]


p_watcont_10_30 = np.array([[0.89,0.81,0.74,0.61,0.55,0.48,0.40,0.34,0.31,0.25,0.23,0.18],
                           [0.91,0.88,0.77,0.60,0.49,0.46,0.44,-999.00,-999.00,0.37,0.34,0.33],
                           [0.86,0.76,0.68,0.52,0.48,-999.00,-999.00,-999.00,-999.00,0.41,0.34,0.25],
                           [0.86,0.81,0.61,0.49,0.38,0.33,0.28,-999.00,-999.00,0.20,0.18,0.18],
                           [0.88,0.87,0.79,0.69,0.63,-999.00,-999.00,-999.00,-999.00,0.48,0.43,0.39]])

p_watcont_30_50 = np.array([[0.89,0.85,0.76,0.68,-999.00,-999.00,0.52,0.39,0.34,0.27,0.24,0.19],
                           [0.86,0.79,0.68,0.62,0.56,0.54,0.51,-999.00,-999.00,0.38,0.35,0.33],
                           [0.89,0.85,0.81,0.69,0.66,0.64,0.62,0.60,0.59,0.55,0.51,0.41],
                           [0.86,0.82,0.79,0.71,0.66,0.62,0.60,0.57,0.56,0.49,0.47,0.32],
                           [0.87,0.85,0.78,0.71,0.61,0.60,0.58,-999.00,-999.00,0.53,0.49,0.47],
                           [0.89,0.86,0.80,0.70,0.61,-999.00,-999.00,-999.00,-999.00,0.44,0.36,0.33],
                           [0.88,0.86,0.83,0.73,-999.00,-999.00,-999.00,0.49,0.44,0.35,0.32,0.24]])

p_watcont_50_70 = np.array([[0.91,0.87,0.81,0.67,0.59,0.50,0.44,0.37,0.34,0.28,0.25,0.20],
                           [0.85,0.81,0.77,0.69,-999.00,-999.00,0.53,0.44,0.41,0.34,0.31,0.25],
                           [0.87,0.83,0.79,0.70,0.65,0.63,0.55,0.48,0.44,0.37,0.34,0.28],
                           [0.91,0.88,0.86,0.82,0.78,0.74,0.71,0.67,0.65,0.61,0.60,0.51],
                           [0.89,0.86,0.81,0.73,0.61,0.56,0.51,-999.00,-999.00,0.45,0.43,0.41],
                           [0.88,0.85,0.81,0.74,0.64,0.62,0.59,-999.00,-999.00,0.51,0.50,0.48]])

p_watcont_70_80 = np.array([[0.90,0.89,0.85,0.77,0.62,0.56,0.52,-999.00,-999.00,0.36,0.32,0.30],
                           [0.88,0.85,0.81,0.75,0.70,-999.00,-999.00,-999.00,-999.00,0.57,0.52,0.49]])

p_watcont_all = np.concatenate((p_watcont_10_30, p_watcont_30_50, p_watcont_50_70, p_watcont_70_80), axis=0)


pF_para_p_10_70 = fit_pF(p_head, [np.average(p_watcont_10_30, axis=0, weights=~np.isin(p_watcont_10_30, -999)*1),
                                  np.average(p_watcont_30_50, axis=0, weights=~np.isin(p_watcont_30_50, -999)*1),
                                  np.average(p_watcont_50_70, axis=0, weights=~np.isin(p_watcont_50_70, -999)*1)],
                percentage=False, kPa=True,fig=True)


pF_para_p_all = fit_pF(p_head, p_watcont_all,
                percentage=False, kPa=False,fig=True)



                                
                                  
                                  
                                  
                                  
                                  